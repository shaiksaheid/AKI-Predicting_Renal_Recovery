<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKI Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <h2 class="text-3xl font-bold mb-8 text-center text-blue-600">Predicting Renal Recovery in ICU Patients Presenting with AKI</h2>
        <h2 class="text-xl font-semibold mb-6 text-center text-gray-700">(ACUTE KIDNEY INJURY)</h2>
        <form id="patient-form" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <p class="text-lg font-bold text-center mt-4 mb-4 text-red-600">Enter the patient details</p>


            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="age">Age</label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700" id="age" name="age" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="gender">Gender</label>
                    <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700" id="gender" name="gender" required>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <!-- Add other input fields as necessary -->
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bic_max">
                        Bicarbonate Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bic_max" name="bic_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bic_mean">
                        Bicarbonate Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bic_mean" name="bic_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bic_min">
                        Bicarbonate Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bic_min" name="bic_min" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bilirubin">
                        Bilirubin
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bilirubin" name="bilirubin" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bp_max">
                        BP Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bp_max" name="bp_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bp_mean">
                        BP Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bp_mean" name="bp_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bp_min">
                        BP Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bp_min" name="bp_min" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bun_max">
                        BUN Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bun_max" name="bun_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bun_mean">
                        BUN Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bun_mean" name="bun_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="bun_min">
                        BUN Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="bun_min" name="bun_min" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="Days_in_uci">
                        Days in UCI
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="Days_in_uci" name="Days_in_uci" type="number" step="1" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="fio2">
                        FiO2
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="fio2" name="fio2" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="gcs_max">
                        GCS Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="gcs_max" name="gcs_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="gcs_mean">
                        GCS Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="gcs_mean" name="gcs_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="gcs_min">
                        GCS Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="gcs_min" name="gcs_min" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="hr_max">
                        HR Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="hr_max" name="hr_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="hr_mean">
                        HR Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="hr_mean" name="hr_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="hr_min">
                        HR Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="hr_min" name="hr_min" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="max_pao2">
                        Max PaO2
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="max_pao2" name="max_pao2" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="mean_pao2">
                        Mean PaO2
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="mean_pao2" name="mean_pao2" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="min_pao2">
                        Min PaO2
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="min_pao2" name="min_pao2" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="pot_max">
                        Potassium Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="pot_max" name="pot_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="pot_mean">
                        Potassium Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="pot_mean" name="pot_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="pot_min">
                        Potassium Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="pot_min" name="pot_min" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="sod_max">
                        Sodium Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="sod_max" name="sod_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="sod_mean">
                        Sodium Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="sod_mean" name="sod_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="sod_min">
                        Sodium Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="sod_min" name="sod_min" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="temp">
                        Temperature
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="temp" name="temp" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="wbc_max">
                        WBC Max
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="wbc_max" name="wbc_max" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="wbc_mean">
                        WBC Mean
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="wbc_mean" name="wbc_mean" type="number" step="0.01" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="wbc_min">
                        WBC Min
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="wbc_min" name="wbc_min" type="number" step="0.01" required>
                </div>
            </div>
            <div class="flex items-center justify-center mt-6 space-x-4">
                <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" type="submit">
                    Predict
                </button>
                <a href="/previous_data" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded">
                    View Previous Data
                </a>
                <a href="/performance" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded">
                    View Performance
                </a>
            </div>
        </form>
        <div id="prediction-result" class="mt-4 text-center text-lg"></div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
    let form = document.getElementById("patient-form");
    
    if (!form) {
        console.error("Form not found! Check if #patient-form exists.");
        return;
    }

    form.addEventListener("submit", async function (e) {
        e.preventDefault();

        let formData = new FormData(this);
        let data = {};

        // Convert form data to JSON
        formData.forEach((value, key) => {
            value = value.trim();
            data[key] = value === "" ? null : isNaN(value) ? value : parseFloat(value);
        });

        console.log("Form Data Sent:", data); // Debugging

        try {
            const response = await fetch("/predict", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });

            const result = await response.json();
            console.log("Prediction Response:", result);

            let predictionText = document.getElementById("prediction-result");

            if (result.success) {
                predictionText.textContent = result.prediction;
                predictionText.className = result.prediction.toLowerCase().includes("die") 
                    ? "text-red-600 font-bold" 
                    : "text-green-600 font-bold";

                // Add row to table if table exists
                let table = document.getElementById("data-table");
                if (table) {
                    let tbody = table.querySelector("tbody");
                    let newRow = tbody.insertRow();
                    
                    Object.values(data).forEach((val, index) => {
                        let newCell = newRow.insertCell(index);
                        newCell.textContent = val !== null ? val : "N/A";
                    });
                }

                // Redirect after 2 seconds if URL is provided
                
            } else {
                predictionText.textContent = "Error: " + result.error;
                predictionText.className = "text-red-600 font-bold";
            }
        } catch (error) {
            console.error("Error:", error);
            let predictionText = document.getElementById("prediction-result");
            predictionText.textContent = "Prediction failed. Please try again.";
            predictionText.className = "text-red-600 font-bold";
        }
    });
});


        </script>        
        
</body>
</html>
